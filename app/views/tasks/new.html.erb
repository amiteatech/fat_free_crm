
<%= simple_form_for(@task, html: { :multipart => true }) do |f| %>
  <%= link_to_close new_task_path + "?view=#{@view}" %>
  <%= hidden_field_tag :view, @view %>
  <%= hidden_field_tag "task[user_id]", current_user.id %>
  <%= hidden_field_tag "task[asset_id]", "#{@asset.id if @asset}" %>
  <%= hidden_field_tag "task[asset_type]", "#{@asset.class if @asset}" %>
  <%= render "tasks/new_top_section",    :f => f %>
  <%= render "fields/groups", :f => f %>
    

  <% if action_name == "new" %>
    <div class="buttonbar first">
      <div class="second">
      <%= radio_button("task", "form_number", "1") %> <label for="task_form_number_1"> <%= link_to 'Workflow', ''  %>  </label>
      </div>
      <div class="second">
       <%= radio_button("task", "form_number", "2") %> <label for="task_form_number_2"> <%= link_to 'Monitoring', '' %> </label>
      </div>
      <div class="second">
       <%= radio_button("task", "form_number", "3") %>  <label for="task_form_number_3"><%= link_to 'Approval',  '' %> </label>
       
      </div>
    </div>
  <% end %>
  <div class="buttonbar">
    <%= f.submit t :create_task %>
    or
    <%= link_to_cancel new_task_path + "?view=#{@view}" %>
  </div>
<% end %>

<script type="text/javascript">
  $(document).ready( function() {
 
$("#users_").on("select2:select", function (evt) {
  var element = evt.params.data.element;
  var $element = $(element);
  
  window.setTimeout(function () {  
  if ($("#users_").find(":selected").length > 1) {
    var $second = $("#users_").find(":selected").eq(-2);
    
    $element.detach();
    $second.after($element);
  } else {
    $element.detach();
    $("#users_").prepend($element);
  }
  
  $("#users_").trigger("change");
  }, 1);
});

$("#users_").on("select2:unselect", function (evt) {
  if ($("#users_").find(":selected").length) {
    var element = evt.params.data.element;
    var $element = $(element);
   $
   ("#users_").find(":selected").after($element); 
  }
});

});

</script>

