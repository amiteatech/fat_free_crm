<table class="company_table report" border="0" cellspacing="0" cellpadding="0" width="100%">	
	<thead>
		<th>Number</th>
	    <th>Task Title</th>
	    <th>Type</th>
	    <th>Due date</th>
	    <th>Staff</th>	
	    <th>Status</th>	
	    <th></th>	
    </thead>
    <tbody>
		<% if current_user.is_super_admin? || current_user.is_admin? || current_user.is_manager? %>
			<% @tasks.order(created_at: :desc).each do |task| %>
		    	<tr>
		    		<td><%=  task.id %></td>
		    		<td>
		    			<label id="<%= dom_id(task, :name) %>">
					      <% if task.user && !current_user.is_super_admin? && (pending.user.id != current_user.id) %>
					        <%= t(:task_from, link_to(h(task.user.full_name), user_path(task.user))).html_safe << ':' %>
					      <% end %>
					        <%= link_to h(task.name), edit_task_path(task.id), :class => "openpop", data: {id: task.id, task_protected: task.password_protected} %>
					    </label>
		    		</td>
		    		<td>
		    			<% if task.task_form_tag_id.present? %>
					        <% if TaskFormTag.where(id: task.task_form_tag_id).first.present? %>
					          <%= TaskFormTag.where(id: tasks.task_form_tag_id).first.name %>
					        <% end %>
					    <% end %>
		    		</td>
		    		<td>
		    			<% if task.due_at.present? %>
					       <%= task.due_at.strftime('%Y-%m-%d %H:%M') %>
					    <% end %>
		    		</td>
		    		<td>
		    			<% task.user_tasks.where.not(id: task.task_created_id).each do |user_task| %>
					        <%  @user = User.find(user_task.user_id) %>
					        <%= @user.name %><%= (task.user_tasks.where.not(id: task.task_created_id).last == user_task) ? "" : "," %>
				        <% end %>
		    		</td>
		    		<td>
		    			<%= task.task_status %>
		    		</td>
		    		<td>
		    			<div class="download_excel" style="margin-top: 0; float: none;">
					        <%= link_to "Trail", show_trails_path(:task_id => task.id), :target => "_blank"  %>
					    </div>
		    		</td>
				</tr>
			<% end %>
		<% end %>	
    </tbody>
</table>